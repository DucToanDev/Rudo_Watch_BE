{
  "openapi": "3.0.3",
  "info": {
    "title": "Rudo Watch API",
    "description": "API Documentation cho hệ thống Rudo Watch E-commerce",
    "version": "1.0.0",
    "contact": {
      "name": "Rudo Watch Team",
      "email": "pductoandev@gmail.com"
    }
  },
  "servers": [
    {
      "url": "http://localhost/backend/api/v1",
      "description": "Local Development"
    },
    {
      "url": "https://rudo-watch-be.onrender.com/api/v1",
      "description": "Render Server"
    }
  ],
  "tags": [
    { "name": "Auth", "description": "Đăng ký, đăng nhập, xác thực" },
    { "name": "User", "description": "Quản lý thông tin người dùng" },
    { "name": "Users (Admin)", "description": "Admin quản lý người dùng" },
    { "name": "Products", "description": "Quản lý sản phẩm" },
    { "name": "Categories", "description": "Quản lý danh mục" },
    { "name": "Brands", "description": "Quản lý thương hiệu" },
    { "name": "Cart", "description": "Giỏ hàng" },
    { "name": "Orders", "description": "Đơn hàng" },
    { "name": "Addresses", "description": "Địa chỉ giao hàng" },
    { "name": "Shipping", "description": "Phương thức vận chuyển" },
    { "name": "Vouchers", "description": "Quản lý mã giảm giá" }
  ],
  "paths": {
    "/register": {
      "post": {
        "tags": ["Auth"],
        "summary": "Đăng ký tài khoản mới",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/RegisterRequest"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Đăng ký thành công",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "400": {
            "description": "Dữ liệu không hợp lệ",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ErrorResponse"
                }
              }
            }
          }
        }
      }
    },
    "/login": {
      "post": {
        "tags": ["Auth"],
        "summary": "Đăng nhập",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/LoginRequest"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Đăng nhập thành công",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "401": {
            "description": "Sai email hoặc mật khẩu"
          }
        }
      }
    },
    "/facebook": {
      "get": {
        "tags": ["Auth"],
        "summary": "Đăng nhập bằng Facebook",
        "responses": {
          "200": {
            "description": "Redirect URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "login_url": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/google": {
      "get": {
        "tags": ["Auth"],
        "summary": "Đăng nhập bằng Google",
        "responses": {
          "200": {
            "description": "Redirect URL",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "login_url": { "type": "string" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/user/profile": {
      "get": {
        "tags": ["User"],
        "summary": "Lấy thông tin người dùng hiện tại",
        "security": [{ "BearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Thông tin user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    },
    "/user/update": {
      "put": {
        "tags": ["User"],
        "summary": "Cập nhật thông tin cá nhân",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/UpdateUserRequest"
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Cập nhật thành công" },
          "401": { "$ref": "#/components/responses/Unauthorized" }
        }
      }
    },
    "/user/change-password": {
      "put": {
        "tags": ["User"],
        "summary": "Đổi mật khẩu",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ChangePasswordRequest"
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Đổi mật khẩu thành công" },
          "400": { "description": "Mật khẩu cũ không đúng" }
        }
      }
    },
    "/users": {
      "get": {
        "tags": ["Users (Admin)"],
        "summary": "Lấy danh sách tất cả người dùng",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 10 } },
          { "name": "search", "in": "query", "schema": { "type": "string" }, "description": "Tìm theo tên, email, SĐT" },
          { "name": "role", "in": "query", "schema": { "type": "integer", "enum": [0, 1] }, "description": "0: User, 1: Admin" },
          { "name": "status", "in": "query", "schema": { "type": "integer", "enum": [0, 1] }, "description": "0: Bị khóa, 1: Hoạt động" }
        ],
        "responses": {
          "200": {
            "description": "Danh sách users",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/UsersListResponse"
                }
              }
            }
          },
          "403": { "$ref": "#/components/responses/Forbidden" }
        }
      }
    },
    "/users/{id}": {
      "get": {
        "tags": ["Users (Admin)"],
        "summary": "Lấy chi tiết người dùng",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": {
            "description": "Thông tin user",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/User" }
              }
            }
          },
          "404": { "description": "Không tìm thấy user" }
        }
      }
    },
    "/users/{id}/status": {
      "put": {
        "tags": ["Users (Admin)"],
        "summary": "Cập nhật trạng thái user (khóa/mở khóa)",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "status": { "type": "integer", "enum": [0, 1] }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Cập nhật thành công" },
          "403": { "$ref": "#/components/responses/Forbidden" }
        }
      }
    },
    "/products": {
      "get": {
        "tags": ["Products"],
        "summary": "Lấy danh sách sản phẩm",
        "parameters": [
          { "name": "page", "in": "query", "schema": { "type": "integer", "default": 1 } },
          { "name": "limit", "in": "query", "schema": { "type": "integer", "default": 12 } },
          { "name": "search", "in": "query", "schema": { "type": "string" } },
          { "name": "category_id", "in": "query", "schema": { "type": "integer" } },
          { "name": "brand_id", "in": "query", "schema": { "type": "integer" } },
          { "name": "min_price", "in": "query", "schema": { "type": "number" } },
          { "name": "max_price", "in": "query", "schema": { "type": "number" } },
          { "name": "sort", "in": "query", "schema": { "type": "string", "enum": ["price_asc", "price_desc", "newest", "bestseller"] } }
        ],
        "responses": {
          "200": {
            "description": "Danh sách sản phẩm",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/ProductsListResponse" }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Products"],
        "summary": "Tạo sản phẩm mới (Admin)",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ProductRequest" }
            }
          }
        },
        "responses": {
          "201": { "description": "Tạo thành công" },
          "403": { "$ref": "#/components/responses/Forbidden" }
        }
      }
    },
    "/products/{id}": {
      "get": {
        "tags": ["Products"],
        "summary": "Lấy chi tiết sản phẩm",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": {
            "description": "Chi tiết sản phẩm",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Product" }
              }
            }
          },
          "404": { "description": "Không tìm thấy sản phẩm" }
        }
      },
      "put": {
        "tags": ["Products"],
        "summary": "Cập nhật sản phẩm (Admin)",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/ProductRequest" }
            }
          }
        },
        "responses": {
          "200": { "description": "Cập nhật thành công" }
        }
      },
      "delete": {
        "tags": ["Products"],
        "summary": "Xóa sản phẩm (Admin)",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": { "description": "Xóa thành công" }
        }
      }
    },
    "/products/featured": {
      "get": {
        "tags": ["Products"],
        "summary": "Lấy sản phẩm nổi bật",
        "responses": {
          "200": {
            "description": "Danh sách sản phẩm nổi bật"
          }
        }
      }
    },
    "/products/latest": {
      "get": {
        "tags": ["Products"],
        "summary": "Lấy sản phẩm mới nhất",
        "responses": {
          "200": {
            "description": "Danh sách sản phẩm mới"
          }
        }
      }
    },
    "/products/category/{categoryId}": {
      "get": {
        "tags": ["Products"],
        "summary": "Lấy sản phẩm theo danh mục",
        "parameters": [
          { "name": "categoryId", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": { "description": "Danh sách sản phẩm" }
        }
      }
    },
    "/products/brand/{brandId}": {
      "get": {
        "tags": ["Products"],
        "summary": "Lấy sản phẩm theo thương hiệu",
        "parameters": [
          { "name": "brandId", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": { "description": "Danh sách sản phẩm" }
        }
      }
    },
    "/categories": {
      "get": {
        "tags": ["Categories"],
        "summary": "Lấy danh sách danh mục",
        "responses": {
          "200": {
            "description": "Danh sách categories",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Category" }
                }
              }
            }
          }
        }
      }
    },
    "/categories/{id}": {
      "get": {
        "tags": ["Categories"],
        "summary": "Lấy chi tiết danh mục",
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": { "description": "Chi tiết category" }
        }
      }
    },
    "/brands": {
      "get": {
        "tags": ["Brands"],
        "summary": "Lấy danh sách thương hiệu",
        "responses": {
          "200": {
            "description": "Danh sách brands",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Brand" }
                }
              }
            }
          }
        }
      }
    },
    "/cart": {
      "get": {
        "tags": ["Cart"],
        "summary": "Lấy giỏ hàng của user",
        "security": [{ "BearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Giỏ hàng",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Cart" }
              }
            }
          }
        }
      }
    },
    "/cart/add": {
      "post": {
        "tags": ["Cart"],
        "summary": "Thêm sản phẩm vào giỏ hàng",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/AddToCartRequest" }
            }
          }
        },
        "responses": {
          "200": { "description": "Thêm thành công" }
        }
      }
    },
    "/cart/update": {
      "put": {
        "tags": ["Cart"],
        "summary": "Cập nhật số lượng sản phẩm",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "variant_id": { "type": "integer" },
                  "quantity": { "type": "integer" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Cập nhật thành công" }
        }
      }
    },
    "/cart/remove": {
      "delete": {
        "tags": ["Cart"],
        "summary": "Xóa sản phẩm khỏi giỏ hàng",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "variant_id": { "type": "integer" }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Xóa thành công" }
        }
      }
    },
    "/cart/sync": {
      "post": {
        "tags": ["Cart"],
        "summary": "Đồng bộ giỏ hàng từ localStorage",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "items": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "variant_id": { "type": "integer" },
                        "quantity": { "type": "integer" }
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Đồng bộ thành công" }
        }
      }
    },
    "/cart/clear": {
      "delete": {
        "tags": ["Cart"],
        "summary": "Xóa toàn bộ giỏ hàng",
        "security": [{ "BearerAuth": [] }],
        "responses": {
          "200": { "description": "Xóa thành công" }
        }
      }
    },
    "/cart/count": {
      "get": {
        "tags": ["Cart"],
        "summary": "Đếm số lượng sản phẩm trong giỏ",
        "security": [{ "BearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Số lượng",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "count": { "type": "integer" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/orders": {
      "get": {
        "tags": ["Orders"],
        "summary": "Lấy danh sách đơn hàng của user",
        "security": [{ "BearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Danh sách đơn hàng",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Order" }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Orders"],
        "summary": "Tạo đơn hàng mới",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/CreateOrderRequest" }
            }
          }
        },
        "responses": {
          "201": { "description": "Tạo đơn hàng thành công" }
        }
      }
    },
    "/orders/{id}": {
      "get": {
        "tags": ["Orders"],
        "summary": "Lấy chi tiết đơn hàng",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": {
            "description": "Chi tiết đơn hàng",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/OrderDetail" }
              }
            }
          }
        }
      }
    },
    "/orders/{id}/cancel": {
      "put": {
        "tags": ["Orders"],
        "summary": "Hủy đơn hàng",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": { "description": "Hủy thành công" },
          "400": { "description": "Không thể hủy đơn hàng" }
        }
      }
    },
    "/orders/admin": {
      "get": {
        "tags": ["Orders"],
        "summary": "Admin lấy tất cả đơn hàng",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "page", "in": "query", "schema": { "type": "integer" } },
          { "name": "limit", "in": "query", "schema": { "type": "integer" } },
          { "name": "status", "in": "query", "schema": { "type": "string" } },
          { "name": "payment_status", "in": "query", "schema": { "type": "string" } }
        ],
        "responses": {
          "200": { "description": "Danh sách đơn hàng" },
          "403": { "$ref": "#/components/responses/Forbidden" }
        }
      }
    },
    "/orders/{id}/status": {
      "put": {
        "tags": ["Orders"],
        "summary": "Admin cập nhật trạng thái đơn hàng",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "status": {
                    "type": "string",
                    "enum": ["pending", "confirmed", "shipping", "delivered", "cancelled"]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Cập nhật thành công" }
        }
      }
    },
    "/orders/{id}/payment-status": {
      "put": {
        "tags": ["Orders"],
        "summary": "Admin cập nhật trạng thái thanh toán",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "payment_status": {
                    "type": "string",
                    "enum": ["pending", "paid", "refunded"]
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": { "description": "Cập nhật thành công" }
        }
      }
    },
    "/orders/statistics": {
      "get": {
        "tags": ["Orders"],
        "summary": "Admin xem thống kê đơn hàng",
        "security": [{ "BearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Thống kê",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/OrderStatistics" }
              }
            }
          }
        }
      }
    },
    "/addresses": {
      "get": {
        "tags": ["Addresses"],
        "summary": "Lấy danh sách địa chỉ",
        "security": [{ "BearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Danh sách địa chỉ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/Address" }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Addresses"],
        "summary": "Thêm địa chỉ mới",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/AddressRequest" }
            }
          }
        },
        "responses": {
          "201": { "description": "Thêm thành công" }
        }
      }
    },
    "/addresses/default": {
      "get": {
        "tags": ["Addresses"],
        "summary": "Lấy địa chỉ mặc định",
        "security": [{ "BearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Địa chỉ mặc định",
            "content": {
              "application/json": {
                "schema": { "$ref": "#/components/schemas/Address" }
              }
            }
          }
        }
      }
    },
    "/addresses/{id}": {
      "put": {
        "tags": ["Addresses"],
        "summary": "Cập nhật địa chỉ",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/AddressRequest" }
            }
          }
        },
        "responses": {
          "200": { "description": "Cập nhật thành công" }
        }
      },
      "delete": {
        "tags": ["Addresses"],
        "summary": "Xóa địa chỉ",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": { "description": "Xóa thành công" }
        }
      }
    },
    "/addresses/{id}/set-default": {
      "put": {
        "tags": ["Addresses"],
        "summary": "Đặt địa chỉ mặc định",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          { "name": "id", "in": "path", "required": true, "schema": { "type": "integer" } }
        ],
        "responses": {
          "200": { "description": "Đặt mặc định thành công" }
        }
      }
    },
    "/shipping-methods": {
      "get": {
        "tags": ["Shipping"],
        "summary": "Lấy danh sách phương thức vận chuyển",
        "responses": {
          "200": {
            "description": "Danh sách shipping methods",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": { "$ref": "#/components/schemas/ShippingMethod" }
                }
              }
            }
          }
        }
      }
    },
    "/shipping-methods/calculate": {
      "post": {
        "tags": ["Shipping"],
        "summary": "Tính phí vận chuyển",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "shipping_method_id": { "type": "integer" },
                  "province": { "type": "string" },
                  "total_weight": { "type": "number" }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Phí vận chuyển",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "shipping_fee": { "type": "number" }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/vouchers": {
      "get": {
        "tags": ["Vouchers"],
        "summary": "Lấy danh sách vouchers",
        "security": [{ "BearerAuth": [] }],
        "responses": {
          "200": {
            "description": "Danh sách vouchers",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": { "$ref": "#/components/schemas/Voucher" }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Vouchers"],
        "summary": "Tạo voucher mới",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/VoucherRequest" }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Tạo voucher thành công",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": { "type": "string" },
                    "data": { "$ref": "#/components/schemas/Voucher" }
                  }
                }
              }
            }
          },
          "400": { "description": "Dữ liệu không hợp lệ" }
        }
      }
    },
    "/vouchers/{id}": {
      "get": {
        "tags": ["Vouchers"],
        "summary": "Lấy chi tiết voucher",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": {
            "description": "Chi tiết voucher",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": { "$ref": "#/components/schemas/Voucher" }
                  }
                }
              }
            }
          },
          "404": { "description": "Không tìm thấy voucher" }
        }
      },
      "put": {
        "tags": ["Vouchers"],
        "summary": "Cập nhật voucher",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": { "$ref": "#/components/schemas/VoucherRequest" }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Cập nhật thành công",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": { "type": "string" },
                    "data": { "$ref": "#/components/schemas/Voucher" }
                  }
                }
              }
            }
          },
          "404": { "description": "Không tìm thấy voucher" }
        }
      },
      "delete": {
        "tags": ["Vouchers"],
        "summary": "Xóa voucher",
        "security": [{ "BearerAuth": [] }],
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": { "type": "integer" }
          }
        ],
        "responses": {
          "200": {
            "description": "Xóa thành công",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": { "type": "string" }
                  }
                }
              }
            }
          },
          "404": { "description": "Không tìm thấy voucher" }
        }
      }
    },
    "/vouchers/validate": {
      "post": {
        "tags": ["Vouchers"],
        "summary": "Kiểm tra mã voucher hợp lệ",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["code", "cart_total"],
                "properties": {
                  "code": { "type": "string", "example": "SUMMER2024" },
                  "cart_total": { "type": "number", "example": 500000 }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Voucher hợp lệ",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "valid": { "type": "boolean" },
                    "data": { "$ref": "#/components/schemas/Voucher" },
                    "discount_amount": { "type": "number" },
                    "message": { "type": "string" }
                  }
                }
              }
            }
          },
          "400": { "description": "Voucher không hợp lệ" }
        }
      }
    },
    "/vouchers/apply": {
      "post": {
        "tags": ["Vouchers"],
        "summary": "Áp dụng voucher vào đơn hàng",
        "security": [{ "BearerAuth": [] }],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["code", "cart_total"],
                "properties": {
                  "code": { "type": "string", "example": "SUMMER2024" },
                  "cart_total": { "type": "number", "example": 500000 }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Áp dụng voucher thành công",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": { "type": "string" },
                    "data": {
                      "type": "object",
                      "properties": {
                        "voucher": { "$ref": "#/components/schemas/Voucher" },
                        "discount_amount": { "type": "number" },
                        "original_total": { "type": "number" },
                        "final_total": { "type": "number" }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": { "description": "Voucher không hợp lệ" }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "BearerAuth": {
        "type": "http",
        "scheme": "bearer",
        "bearerFormat": "API Token"
      }
    },
    "responses": {
      "Unauthorized": {
        "description": "Chưa đăng nhập hoặc token hết hạn",
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/ErrorResponse" }
          }
        }
      },
      "Forbidden": {
        "description": "Không có quyền truy cập",
        "content": {
          "application/json": {
            "schema": { "$ref": "#/components/schemas/ErrorResponse" }
          }
        }
      }
    },
    "schemas": {
      "ErrorResponse": {
        "type": "object",
        "properties": {
          "error": { "type": "string" }
        }
      },
      "RegisterRequest": {
        "type": "object",
        "required": ["fullname", "email", "password"],
        "properties": {
          "fullname": { "type": "string", "example": "Nguyễn Văn A" },
          "email": { "type": "string", "format": "email", "example": "user@example.com" },
          "phone": { "type": "string", "example": "0912345678" },
          "password": { "type": "string", "minLength": 6, "example": "123456" }
        }
      },
      "LoginRequest": {
        "type": "object",
        "required": ["email", "password"],
        "properties": {
          "email": { "type": "string", "format": "email" },
          "password": { "type": "string" }
        }
      },
      "AuthResponse": {
        "type": "object",
        "properties": {
          "message": { "type": "string" },
          "user": { "$ref": "#/components/schemas/User" },
          "token": { "type": "string" }
        }
      },
      "User": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "fullname": { "type": "string" },
          "email": { "type": "string" },
          "phone": { "type": "string" },
          "role": { "type": "integer", "description": "0: User, 1: Admin" },
          "status": { "type": "integer", "description": "0: Bị khóa, 1: Hoạt động" },
          "created_at": { "type": "string", "format": "date-time" }
        }
      },
      "UpdateUserRequest": {
        "type": "object",
        "properties": {
          "fullname": { "type": "string" },
          "phone": { "type": "string" }
        }
      },
      "ChangePasswordRequest": {
        "type": "object",
        "required": ["current_password", "new_password"],
        "properties": {
          "current_password": { "type": "string" },
          "new_password": { "type": "string", "minLength": 6 }
        }
      },
      "UsersListResponse": {
        "type": "object",
        "properties": {
          "users": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/User" }
          },
          "pagination": { "$ref": "#/components/schemas/Pagination" }
        }
      },
      "Pagination": {
        "type": "object",
        "properties": {
          "current_page": { "type": "integer" },
          "per_page": { "type": "integer" },
          "total": { "type": "integer" },
          "total_pages": { "type": "integer" }
        }
      },
      "Product": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "name": { "type": "string" },
          "slug": { "type": "string" },
          "description": { "type": "string" },
          "price": { "type": "number" },
          "sale_price": { "type": "number" },
          "image": { "type": "string" },
          "category_id": { "type": "integer" },
          "brand_id": { "type": "integer" },
          "stock": { "type": "integer" },
          "is_featured": { "type": "boolean" },
          "created_at": { "type": "string", "format": "date-time" }
        }
      },
      "ProductRequest": {
        "type": "object",
        "required": ["name", "price"],
        "properties": {
          "name": { "type": "string" },
          "description": { "type": "string" },
          "price": { "type": "number" },
          "sale_price": { "type": "number" },
          "category_id": { "type": "integer" },
          "brand_id": { "type": "integer" },
          "stock": { "type": "integer" },
          "is_featured": { "type": "boolean" }
        }
      },
      "ProductsListResponse": {
        "type": "object",
        "properties": {
          "products": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/Product" }
          },
          "pagination": { "$ref": "#/components/schemas/Pagination" }
        }
      },
      "Category": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "name": { "type": "string" },
          "slug": { "type": "string" },
          "description": { "type": "string" },
          "image": { "type": "string" }
        }
      },
      "Brand": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "name": { "type": "string" },
          "slug": { "type": "string" },
          "logo": { "type": "string" }
        }
      },
      "Cart": {
        "type": "object",
        "properties": {
          "items": {
            "type": "array",
            "items": { "$ref": "#/components/schemas/CartItem" }
          },
          "total": { "type": "number" }
        }
      },
      "CartItem": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "variant_id": { "type": "integer" },
          "product_name": { "type": "string" },
          "variant_name": { "type": "string" },
          "price": { "type": "number" },
          "quantity": { "type": "integer" },
          "image": { "type": "string" }
        }
      },
      "AddToCartRequest": {
        "type": "object",
        "required": ["variant_id", "quantity"],
        "properties": {
          "variant_id": { "type": "integer" },
          "quantity": { "type": "integer", "minimum": 1 }
        }
      },
      "Order": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "order_code": { "type": "string" },
          "user_id": { "type": "integer" },
          "total_amount": { "type": "number" },
          "shipping_fee": { "type": "number" },
          "discount_amount": { "type": "number" },
          "final_amount": { "type": "number" },
          "status": { "type": "string", "enum": ["pending", "confirmed", "shipping", "delivered", "cancelled"] },
          "payment_method": { "type": "string" },
          "payment_status": { "type": "string", "enum": ["pending", "paid", "refunded"] },
          "created_at": { "type": "string", "format": "date-time" }
        }
      },
      "OrderDetail": {
        "allOf": [
          { "$ref": "#/components/schemas/Order" },
          {
            "type": "object",
            "properties": {
              "items": {
                "type": "array",
                "items": { "$ref": "#/components/schemas/OrderItem" }
              },
              "shipping_address": { "$ref": "#/components/schemas/Address" }
            }
          }
        ]
      },
      "OrderItem": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "product_name": { "type": "string" },
          "variant_name": { "type": "string" },
          "price": { "type": "number" },
          "quantity": { "type": "integer" },
          "image": { "type": "string" }
        }
      },
      "CreateOrderRequest": {
        "type": "object",
        "required": ["address_id", "shipping_method_id", "payment_method"],
        "properties": {
          "address_id": { "type": "integer" },
          "shipping_method_id": { "type": "integer" },
          "payment_method": { "type": "string", "enum": ["cod", "banking", "momo"] },
          "voucher_code": { "type": "string" },
          "note": { "type": "string" }
        }
      },
      "OrderStatistics": {
        "type": "object",
        "properties": {
          "total_orders": { "type": "integer" },
          "total_revenue": { "type": "number" },
          "pending_orders": { "type": "integer" },
          "delivered_orders": { "type": "integer" },
          "cancelled_orders": { "type": "integer" }
        }
      },
      "Address": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "fullname": { "type": "string" },
          "phone": { "type": "string" },
          "province": { "type": "string" },
          "district": { "type": "string" },
          "ward": { "type": "string" },
          "address_detail": { "type": "string" },
          "is_default": { "type": "boolean" }
        }
      },
      "AddressRequest": {
        "type": "object",
        "required": ["fullname", "phone", "province", "district", "ward", "address_detail"],
        "properties": {
          "fullname": { "type": "string" },
          "phone": { "type": "string" },
          "province": { "type": "string" },
          "district": { "type": "string" },
          "ward": { "type": "string" },
          "address_detail": { "type": "string" },
          "is_default": { "type": "boolean" }
        }
      },
      "ShippingMethod": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "name": { "type": "string" },
          "description": { "type": "string" },
          "base_fee": { "type": "number" },
          "estimated_days": { "type": "string" }
        }
      },
      "Voucher": {
        "type": "object",
        "properties": {
          "id": { "type": "integer" },
          "code": { "type": "string", "example": "SUMMER2024" },
          "name": { "type": "string", "example": "Giảm giá mùa hè" },
          "description": { "type": "string" },
          "discount_type": { "type": "string", "enum": ["percentage", "fixed"], "description": "percentage: Giảm %, fixed: Giảm số tiền cố định" },
          "discount_value": { "type": "number", "example": 10 },
          "min_order_value": { "type": "number", "example": 500000, "description": "Giá trị đơn hàng tối thiểu" },
          "max_discount": { "type": "number", "example": 100000, "description": "Số tiền giảm tối đa (cho loại percentage)" },
          "usage_limit": { "type": "integer", "example": 100, "description": "Số lần sử dụng tối đa" },
          "used_count": { "type": "integer", "example": 10, "description": "Số lần đã sử dụng" },
          "start_date": { "type": "string", "format": "date-time", "example": "2024-06-01T00:00:00" },
          "end_date": { "type": "string", "format": "date-time", "example": "2024-08-31T23:59:59" },
          "status": { "type": "integer", "enum": [0, 1], "description": "0: Inactive, 1: Active" },
          "created_at": { "type": "string", "format": "date-time" },
          "updated_at": { "type": "string", "format": "date-time" }
        }
      },
      "VoucherRequest": {
        "type": "object",
        "required": ["code", "name", "discount_type", "discount_value", "start_date", "end_date"],
        "properties": {
          "code": { "type": "string", "example": "SUMMER2024", "description": "Mã voucher (unique)" },
          "name": { "type": "string", "example": "Giảm giá mùa hè" },
          "description": { "type": "string" },
          "discount_type": { "type": "string", "enum": ["percentage", "fixed"], "description": "percentage: Giảm %, fixed: Giảm số tiền cố định" },
          "discount_value": { "type": "number", "example": 10, "description": "Giá trị giảm (% hoặc số tiền)" },
          "min_order_value": { "type": "number", "example": 500000, "description": "Giá trị đơn hàng tối thiểu để áp dụng" },
          "max_discount": { "type": "number", "example": 100000, "description": "Số tiền giảm tối đa (chỉ dùng cho percentage)" },
          "usage_limit": { "type": "integer", "example": 100, "description": "Số lần sử dụng tối đa (null = không giới hạn)" },
          "start_date": { "type": "string", "format": "date-time", "example": "2024-06-01T00:00:00" },
          "end_date": { "type": "string", "format": "date-time", "example": "2024-08-31T23:59:59" },
          "status": { "type": "integer", "enum": [0, 1], "default": 1, "description": "0: Inactive, 1: Active" }
        }
      }
    }
  }
}
